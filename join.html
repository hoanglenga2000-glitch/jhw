<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>成为教员 | 智慧家教桥</title>
    <link href="https://cdn.bootcdn.net/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        :root { --primary: #6366F1; --bg-dark: #0F172A; --glass: rgba(30, 41, 59, 0.8); --border: rgba(255, 255, 255, 0.1); --text: #F8FAFC; --text-gray: #94A3B8; }
        * { margin:0; padding:0; box-sizing:border-box; font-family:sans-serif; }
        body { background: var(--bg-dark); color: var(--text); min-height: 100vh; display:flex; flex-direction:column; align-items:center; }
        .bg-glow { position: fixed; width: 600px; height: 600px; background: radial-gradient(circle, rgba(99,102,241,0.15), transparent 70%); border-radius: 50%; pointer-events: none; z-index: -1; }
        
        header { width: 100%; padding: 20px 40px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--border); background: rgba(15,23,42,0.9); backdrop-filter: blur(10px); position: sticky; top: 0; z-index: 100; }
        .logo { font-size: 1.4rem; font-weight: bold; color: white; text-decoration: none; }
        
        .container { margin-top: 50px; width: 100%; max-width: 800px; padding: 0 20px; padding-bottom: 50px; }
        .form-card { background: var(--glass); border: 1px solid var(--border); padding: 40px; border-radius: 24px; box-shadow: 0 20px 50px rgba(0,0,0,0.3); }
        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 25px; }
        .form-item { display: flex; flex-direction: column; gap: 8px; }
        .form-item.full { grid-column: span 2; }
        label { color: var(--text-gray); font-size: 0.9rem; }
        .required { color: #EF4444; margin-left: 4px; }
        input, select, textarea { background: #1E293B; border: 1px solid var(--border); padding: 12px; border-radius: 8px; color: white; outline: none; transition: 0.3s; }
        input:focus { border-color: var(--primary); }
        
        .upload-box { border: 2px dashed var(--border); padding: 30px; text-align: center; border-radius: 12px; cursor: pointer; transition: 0.3s; background: rgba(255,255,255,0.02); }
        .upload-box:hover { border-color: var(--primary); background: rgba(99,102,241,0.05); }
        
        .btn { width: 100%; padding: 15px; background: linear-gradient(135deg, var(--primary), #4F46E5); border: none; border-radius: 12px; color: white; font-weight: bold; font-size: 1.1rem; cursor: pointer; margin-top: 30px; }
        .btn:disabled { background: #4B5563; cursor: not-allowed; }
    </style>
</head>
<body>
    <div class="bg-glow" style="top:-100px; left:-100px;"></div>
    <header>
        <a href="index.html" class="logo"><i class="fas fa-graduation-cap"></i> 智慧家教桥</a>
        <a href="index.html" style="color:var(--text-gray); text-decoration:none;">返回首页</a>
    </header>

    <div class="container">
        <div class="form-card">
            <h1 style="text-align:center; margin-bottom:10px;">大学生教员入驻</h1>
            <p style="text-align:center; color:var(--text-gray); margin-bottom:30px;">请完善以下信息，管理员审核通过后即可接单</p>

            <div class="form-grid">
                <div class="form-item"><label>真实姓名<span class="required">*</span></label><input type="text" id="name"></div>
                <div class="form-item"><label>性别<span class="required">*</span></label><select id="gender"><option>男</option><option>女</option></select></div>
                <div class="form-item"><label>手机号 (登录账号)<span class="required">*</span></label><input type="text" id="phone"></div>
                <div class="form-item"><label>设置密码<span class="required">*</span></label><input type="password" id="password"></div>
                <div class="form-item"><label>就读高校<span class="required">*</span></label><input type="text" id="school" placeholder="如：南京工业大学"></div>
                <div class="form-item"><label>所学专业<span class="required">*</span></label><input type="text" id="major"></div>
                <div class="form-item full"><label>擅长科目 (空格分隔)<span class="required">*</span></label><input type="text" id="subject" placeholder="如：初中数学 高中物理"></div>
                
                <div class="form-item full">
                    <label>学生证/录取通知书 (必须上传)<span class="required">*</span></label>
                    <div class="upload-box" onclick="document.getElementById('file').click()">
                        <i class="fas fa-cloud-upload-alt" style="font-size:2rem; color:var(--text-gray); margin-bottom:10px;"></i>
                        <p id="fileName">点击选择图片 (JPG/PNG)</p>
                        <input type="file" id="file" style="display:none" onchange="previewFile()">
                    </div>
                </div>

                <div class="form-item full"><label>自我介绍<span class="required">*</span></label><textarea id="intro" rows="4" placeholder="简单介绍一下你的优势..."></textarea></div>
            </div>

            <button class="btn" onclick="submitJoin()">提交审核</button>
        </div>
    </div>

    <script>
        function previewFile() {
            const file = document.getElementById('file').files[0];
            if(file) {
                document.getElementById('fileName').innerText = "已选择: " + file.name;
                document.getElementById('fileName').style.color = "#10B981";
            }
        }

        function submitJoin() {
            // 1. 获取字段
            let name = document.getElementById('name').value.trim();
            let gender = document.getElementById('gender').value;
            let phone = document.getElementById('phone').value.trim();
            let pass = document.getElementById('password').value.trim();
            let school = document.getElementById('school').value.trim();
            let major = document.getElementById('major').value.trim();
            let subject = document.getElementById('subject').value.trim();
            let intro = document.getElementById('intro').value.trim();
            let file = document.getElementById('file').files[0];

            // 2. 强制校验
            if (!name) return alert("请输入姓名");
            if (!phone) return alert("请输入手机号");
            if (!pass) return alert("请设置密码");
            if (!school) return alert("请输入学校");
            if (!major) return alert("请输入专业");
            if (!subject) return alert("请输入擅长科目");
            if (!intro) return alert("请输入自我介绍");
            if (!file) return alert("⚠️ 请务必上传学生证照片，否则无法审核！");

            // 3. 构造数据
            let fd = new FormData();
            fd.append('name', name);
            fd.append('gender', gender);
            fd.append('phone', phone);
            fd.append('password', pass);
            fd.append('school', school);
            fd.append('major', major);
            fd.append('subject', subject);
            fd.append('intro', intro);
            fd.append('id_photo', file);

            const btn = document.querySelector('.btn');
            btn.innerText = "提交中...";
            btn.disabled = true;

            // 4. 发送
            fetch('api/teacher_api.php?action=register', {
                method: 'POST',
                body: fd
            })
            .then(r => r.json())
            .then(d => {
                if(d.status === 'success') {
                    alert("✅ 申请已提交！\n请等待管理员审核，审核通过后即可登录后台。");
                    window.location.href = 'index.html';
                } else {
                    alert("❌ 提交失败：" + d.message);
                    btn.innerText = "提交审核";
                    btn.disabled = false;
                }
            })
            .catch(e => {
                console.error(e);
                alert("❌ 网络错误或服务器异常");
                btn.innerText = "提交审核";
                btn.disabled = false;
            });
        }
    </script>
</body>
</html>